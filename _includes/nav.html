<nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      {%- if site.title-img -%}
        {% if page.url contains '/journal' %}
        <a class="navbar-brand navbar-brand-logo" href="{{ '/journal' | relative_url }}"><img src="{{ site.title-img }}"/></a>
        {% else %}
        <a class="navbar-brand navbar-brand-logo" href="{{ '/' | relative_url }}"><img src="{{ site.title-img }}"/></a>
        {% endif %}
      {%- else -%}
        {% if page.url contains '/journal' %}
        <a class="navbar-brand" href="{{ '/journal' | relative_url }}">Steffen Wöll</a>
        {% else %}
        <a class="navbar-brand" href="{{ '/' | relative_url }}">Steffen Wöll</a>
        {% endif %}
      {%- endif -%}
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        {%- for link in site.navbar-links -%}
        {%- if link[1].first %}
        <li class="navlinks-container">
          <a class="navlinks-parent" href="javascript:void(0)">{{ link[0] }}</a>
          <div class="navlinks-children">
            {%- for childlink in link[1] -%}
            {%- for linkparts in childlink %}
            <a href="{{ linkparts[1] | relative_url }}">{{ linkparts[0] }}</a>
            {%- endfor -%}
            {%- endfor %}
          </div>
        </li>
        {% else %}
        <li><a href="{{ link[1] | relative_url }}">{{ link[0] }}</a></li>
        {%- endif -%}
        {%- endfor -%}
      </ul>
    </div>

    {% if page.image and (layout.show-avatar or page.show-avatar) %}
    <div class="avatar-container">
      <div class="avatar-img-border">
        <a href="{{ '' | absolute_url }}">
          <img class="avatar-img" src="{{ page.image | relative_url }}" alt="avatar-img">
        </a>
      </div>
    </div>
    {% elsif site.avatar and (layout.show-avatar or page.show-avatar) %}
    <div class="avatar-container">
      <div class="avatar-img-border">
        <a href="{{ '' | absolute_url }}">
          <img class="avatar-img" src="{{ site.avatar | relative_url }}" alt="avatar-img">
        </a>
      </div>
    </div>
    {% endif %}

  </div>
</nav>

{% assign journal_url = '/journal' | relative_url %}
{% assign current_url = page.url | relative_url %}

<script>
  document.addEventListener("DOMContentLoaded", function() {
    var navbarLogo = document.querySelector(".navbar-brand-logo");
    if (navbarLogo) {
      if (current_url.startsWith(journal_url)) {
        navbarLogo.href = journal_url;
      } else {
        navbarLogo.href = '/';
      }
    }
  });
</script>
